<div id="header">
<h1>The Database</h1>
<h2>Welcome Back</h2>
</div>

<p>This is your interface to the Automated PageCaptain system, your gateway to
the List.  Check out our <a href="<& SELF:base &>wiki.mhtml">Wiki Homepage</a>
for the latest news.  </p>

<p>If you <b>don't</b> have an account, take the 
    <a href="<& SELF:base&>survey.mhtml">SURVEY</a> to get one.
</p>

<p>Not getting FIST emails? Hop over to
<a href="https://listhost.uchicago.edu/mailman/listinfo/potato"> the
listhost server</a> to subscribe to our mailing list.
</p>

% if ($User->isvalid) {
<h3>Watched Items</h3>

%   if ($#watchlist > -1) {
<& user/itemtable.mas, list => \@watchlist &>
%     if ($#noted > -1) {
<h3>New Comments Alert</h3>
<p>Of these items, the following have new comments since your last recorded
   visit:</p>

<& user/itemgrid.mas, list => \@noted, expand => 0 &>
<p>Click <a href="<& SELF:base &>index.mhtml?visit=1">Record This Visit</a> to 
clear the above list.</p>

%     }
%   } else {
<p>You are not watching any items at this time.</p>
%   }
% }

<%method title>
<& PARENT:title &> HQ
</%method>
<%method time_stamp>
<!-- hhmts start -->
Last modified: Thu May 11 19:01:35 CDT 2006
<!-- hhmts end -->
</%method>

<%args>
$visit => undef;
</%args>
<%init>

# If we are a validated user, generate a watchlist

my @watchlist = ( );
my @noted = ( );
if ($User->isvalid) {
  if ($visit) { $User->reset_notes_time; }
  my @items = PageCapt::DB::get_watched_byuser( $User );
  @watchlist = PageCapt::DB::load_list_inums( @items );
  @items = 
    PageCapt::DB::get_new_noted_items( $User->notes_time, $User->uid );
  @noted = PageCapt::DB::load_list_inums( @items );
}

</%init>
